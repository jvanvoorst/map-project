var app=angular.module("mapApp",["leaflet-directive","ui.bootstrap","ngAnimate","geolocation"]);app.controller("mapController",["$scope","$modal","$log","geolocation",function(e,r,a,o){for(e.markers=markers14er,e.userOpen={show:!1},e.fourteenerOpen={show:!1},e.searchText={text:""},e.coords=o.getLocation().then(function(e){return{lat:e.coords.latitude,"long":e.coords.longitude}}),angular.extend(e,{Boulder:{lat:40.011,lng:-105.271,zoom:12},London:{lat:51.505,lng:-.09,zoom:12},tmb:{lat:45.7715,lng:6.8901,zoom:12},defaults:{scrollWheelZoom:!1,maxZoom:15},layers:{baselayers:{fourumaps:{name:"4uMaps",url:"http://tileserver.4umaps.eu/{z}/{x}/{y}.png",type:"xyz"},opencyclemap:{name:"OpenCycleMap",url:"http://{s}.tile.opencyclemap.org/cycle/{z}/{x}/{y}.png",type:"xyz"},openstreetmap:{name:"OpenStreetMap",url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",type:"xyz"}},overlays:{fourteeners:{type:"group",name:"14ers",visible:!0},user:{type:"group",name:"User",visible:!0}}},extraMarkerIconRed:{type:"extraMarker",icon:"fa-star",markerColor:"red",prefix:"fa",shape:"circle"},extraMarkerIconBlue:{type:"extraMarker",icon:"fa-star",markerColor:"blue-dark",prefix:"fa",shape:"circle"}}),i=0;i<e.markers.length;i++)e.markers[i].icon=e.extraMarkerIconBlue;e.center=angular.copy(e.Boulder),e.changeCenter=function(r){e.center=angular.copy(r)},e.centerOnMarker=function(r){e.center={lat:r.lat,lng:r.lng,zoom:12},scrollTo(document.body,425,0)},e.centerCurrent=function(){e.center={lat:e.coords.$$state.value.lat,lng:e.coords.$$state.value["long"],zoom:12}},e.$on("leafletDirectiveMarker.dragend",function(r,a){e.markers[a.modelName].lat=a.model.lat,e.markers[a.modelName].lng=a.model.lng}),e.editMarker=function(r){e.open(!0,r)},e.deleteMarker=function(r){for(var a=0;a<e.markers.length;a++)if(e.markers[a].message===r.message)return void e.markers.splice(a,1)},e.$on("leafletDirectiveMap.click",function(r,a){var o=a.leafletEvent;e.open(!1),e.addMarker=function(r){e.markers.push({lat:o.latlng.lat,lng:o.latlng.lng,message:r,draggable:!0,layer:"user",icon:e.extraMarkerIconRed}),e.userOpen.show=!0}}),e.open=function(a,o){var n=r.open({animation:!0,templateUrl:"ModalContent.html",controller:"modalController",size:"lg"});a?n.result.then(function(e){o.message=e}):n.result.then(function(r){e.addMarker(r)})}}]),app.controller("modalController",["$scope","$modalInstance",function(e,r){e.ok=function(){r.close(e.comment)},e.cancel=function(){r.dismiss("cancel")}}]);